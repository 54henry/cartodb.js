<!DOCTYPE html>
<html>
  <head>
    <title>Easy example | CartoDB.js</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <link rel="shortcut icon" href="http://cartodb.com/assets/favicon.ico" />
    <link rel="stylesheet" href="../../dist/themes/css/cartodb.css" />
    <style>
      html, body, #map {
        height: 100%;
        padding: 0;
        margin: 0;
      }
    </style>
  </head>
  <body>
    <div id="map"></div>

    <!-- include cartodb.js library -->
    <script src="../../dist/cartodb.uncompressed.js"></script>

    <script>
      function main() {


var vizjson = {
  "id": "a397acb0-92a2-11e5-b577-080027880ca6",
  "version": "0.1.0",
  "title": "Untitled Map",
  "likes": 0,
  "description": null,
  "scrollwheel": false,
  "legends": true,
  "url": null,
  "map_provider": "leaflet",
  "bounds": [
    [
      -85.0511,
      -179
    ],
    [
      82.4833231803594,
      179
    ]
  ],
  "center": "[-1.2838884098202996,0]",
  "zoom": 1,
  "updated_at": "2015-12-07T20:15:42+00:00",
  "layers": [
    {
      "options": {
        "default": true,
        "url": "http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",
        "subdomains": "abcd",
        "minZoom": "0",
        "maxZoom": "18",
        "name": "Positron",
        "className": "positron_rainbow_labels",
        "attribution": "© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href= \"http://cartodb.com/attributions#basemaps\">CartoDB</a>",
        "labels": {
          "url": "http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png"
        },
        "urlTemplate": "http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png"
      },
      "infowindow": null,
      "tooltip": null,
      "id": "9527c927-260f-40dd-bd6d-b20f0a676927",
      "order": 0,
      "type": "tiled"
    },
    {
      "type": "layergroup",
      "options": {
        "user_name": "cdb",
        "maps_api_template": "http://{user}.localhost.lan:8181",
        "sql_api_template": "http://{user}.localhost.lan:8080",
        "tiler_protocol": "http",
        "tiler_domain": "localhost.lan",
        "tiler_port": "8181",
        "sql_api_protocol": "http",
        "sql_api_domain": "localhost.lan",
        "sql_api_endpoint": "/api/v1/sql",
        "sql_api_port": 8080,
        "filter": "mapnik",
        "layer_definition": {
          "stat_tag": "a397acb0-92a2-11e5-b577-080027880ca6",
          "version": "1.0.1",
          "layers": [
            {
              "id": "2570e105-7b37-40d2-bdf4-1af889598745",
              "type": "CartoDB",
              "infowindow": {
                "fields": [],
                "template_name": "table/views/infowindow_light",
                "template": "<div class=\"cartodb-popup v2\">\n  <a href=\"#close\" class=\"cartodb-popup-close-button close\">x</a>\n  <div class=\"cartodb-popup-content-wrapper\">\n    <div class=\"cartodb-popup-content\">\n      {{#content.fields}}\n        {{#title}}<h4>{{title}}</h4>{{/title}}\n        {{#value}}\n          <p {{#type}}class=\"{{ type }}\"{{/type}}>{{{ value }}}</p>\n        {{/value}}\n        {{^value}}\n          <p class=\"empty\">null</p>\n        {{/value}}\n      {{/content.fields}}\n    </div>\n  </div>\n  <div class=\"cartodb-popup-tip-container\"></div>\n</div>\n",
                "alternative_names": {},
                "width": 226,
                "maxHeight": 180
              },
              "tooltip": {
                "fields": [],
                "template_name": "tooltip_light",
                "template": "<div class=\"cartodb-tooltip-content-wrapper\">\n  <div class=\"cartodb-tooltip-content\">\n  {{#fields}}\n    {{#title}}\n    <h4>{{title}}</h4>\n    {{/title}}\n    <p>{{{ value }}}</p>\n  {{/fields}}\n  </div>\n</div>",
                "alternative_names": {},
                "maxHeight": 180
              },
              "legend": {
                "type": "none",
                "show_title": false,
                "title": "",
                "template": "",
                "visible": true
              },
              "order": 1,
              "visible": true,
              "options": {
                "sql": "select * from ne_10m_populated_places_simple_6",
                "layer_name": "ne_10m_populated_places_simple_6",
                "cartocss": "/** simple visualization */\n\n#ne_10m_populated_places_simple_6{\n  marker-fill-opacity: 0.9;\n  marker-line-color: #FFF;\n  marker-line-width: 1;\n  marker-line-opacity: 1;\n  marker-placement: point;\n  marker-type: ellipse;\n  marker-width: 10;\n  marker-fill: #FF6600;\n  marker-allow-overlap: true;\n}",
                "cartocss_version": "2.1.1",
                "interactivity": "cartodb_id",
                "table_name": "\"\"."
              }
            }
          ]
        },
        "attribution": ""
      }
    },
    {
      "options": {
        "default": true,
        "url": "http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",
        "subdomains": "abcd",
        "minZoom": "0",
        "maxZoom": "18",
        "attribution": "© <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors © <a href= \"http://cartodb.com/attributions#basemaps\">CartoDB</a>",
        "urlTemplate": "http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png",
        "type": "Tiled",
        "name": "Positron Labels"
      },
      "infowindow": null,
      "tooltip": null,
      "id": "e75f6823-f0b7-414c-a070-77b8250f956d",
      "order": 2,
      "type": "tiled"
    }
  ],
  "overlays": [
    {
      "type": "share",
      "order": 2,
      "options": {
        "display": true,
        "x": 20,
        "y": 20
      },
      "template": ""
    },
    {
      "type": "search",
      "order": 3,
      "options": {
        "display": true,
        "x": 60,
        "y": 20
      },
      "template": ""
    },
    {
      "type": "zoom",
      "order": 6,
      "options": {
        "display": true,
        "x": 20,
        "y": 20
      },
      "template": "<a href=\"#zoom_in\" class=\"zoom_in\">+</a> <a href=\"#zoom_out\" class=\"zoom_out\">-</a>"
    },
    {
      "type": "loader",
      "order": 8,
      "options": {
        "display": true,
        "x": 20,
        "y": 150
      },
      "template": "<div class=\"loader\" original-title=\"\"></div>"
    },
    {
      "type": "logo",
      "order": 9,
      "options": {
        "display": true,
        "x": 10,
        "y": 40
      },
      "template": ""
    }
  ],
  "prev": null,
  "next": null,
  "transition_options": {
    "time": 0
  }
};


  vizjson.datasource = {
    "user_name": vizjson.layers[1].options.user_name,
    "maps_api_template": vizjson.layers[1].options.maps_api_template,
    "force_cors": true, // This is sometimes set in the editor,
    "stat_tag": vizjson.layers[1].options.layer_definition.stat_tag
  }

  console.log(vizjson);
        cartodb.createVis('map', vizjson, {})
        .done(function(vis, layers) {
        })
        .error(function(err) {
          console.log(err);
        });
      }

      window.onload = main;

    </script>
  </body>
</html>
